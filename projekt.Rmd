---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Gašper Potočnik"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex

---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.R", encoding="UTF-8")
```

# Analiza igralcev NBA

Analizirali bomo podatke o igralcih lige NBA v zadnjih 20 letih. Predvsem se bomo oredotočili na razlike med igralci iz Amerike in ostalimi.

![](slike/Nba-logo.jpg)

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz_pravi.r", encoding="UTF-8")
source('podatki/urejanje/urejanje22.R')
```

Podatke sem prekopiral in shranil v xlsx. datoteke iz uradne spletne strani NBA ter jih nato uvozil. 
Nato sem vse podatke iz različnih let združil v eno tabelo.

1. Tabele
  - `osebni_podatki_skupni` - podatki o vseh igralcih v vsem opazovanem obdobju
  - `povprecje_osebni_podatki` - podatki za posamezne igralce (tisti, ki so igrali več let imajo predstavljene povprečne podatke)
  - `povprecje_drzave` - podatki o povprečju, ki ga prispevajo vsi igralci iz iste države
  - `stevilo_igralcev` - število igralcev iz vsake države 
  - `amerika_svet` - primerjava števila igralcev, ki so iz Amerike in ostalimi
  - `top10_drzav_igralci` - top 10 držav z največ igralci v NBA
  - `top10_drzav_tocke` - top 10 držav z največjim povprečinim številom točk na igralca
  
2. Spremenljivke
  - `vsi_igralci`, `igrlci_amerika`, `igralci_ostali`
  - `stevilo` - vektor, ki pove število vseh igralcev, ameriških igralcev in ostalih igralcev
  

Spodnji graf prikazuje 10 držav, iz katerih je bilo v opazovanem obdobju največ igralcev v ligi NBA. 
Pri tem se ne upošteva ZDA.

```{r stolpicni_diagram, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Graf 10 držav z največ igralci v NBA'}
ggplot(top10_drzav_igralci) + aes(x=COUNTRY, y=stevilo) + geom_col(fill = 'red')+
ggtitle("Top 10 držav z največ igralci v NBA") + theme(panel.background = element_rect(fill = 'grey')) 
```
Diagram prikazuje porazdelitev med številom Ameriških in številom ostalih igralcev v NBA.
```{r tortni_diagram, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Primerjava števila ameriških in ostalih igralcev'}
pie(stevilo[-1], labels = ime[-1], main = 'Število ameriških proti ostalim igralcem')
```

```{r stolpicni, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Graf povprečja točk na državo'}
ggplot(top10_drzav_tocke) + aes(x=COUNTRY, y=PTS) + geom_col(fill='green') +
ggtitle("Top 10 držav z največjim povprečinim številom točk na igralca") 
```
# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("vizualizacija/zemljevid.R", encoding="UTF-8")
```

Spodnji zemljevid prikazuje stevilo igralcev iz posamezne države, ki igrajo oz. so igrali v NBA 

```{r zemljevid1, echo=FALSE, fig.align='center', fig.cap='Zemljevid števila igralcev iz posamezne države'}
tm_shape(merge(svet, stevilo_igralcev, by.x="NAME_LONG", by.y="COUNTRY")) + tm_polygons("stevilo")
```

Zemljevid prikazuje povprečje točk na igralca za vsako državo.
```{r zemljevid2, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečja točk'}
tm_shape(merge(svet, povprecje_drzave, by.x="NAME_LONG", by.y="COUNTRY")) + tm_polygons("PTS")
```

